The IDL, Python, and Fortran versions run without error and produce roughly identical results.

The C version runs without error but gets a different answer than IDL/Python, presumably due to issues with variable type.
